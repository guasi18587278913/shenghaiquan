# 深海圈课程数据导入指南

## 导入步骤

### 1. 准备工作

#### 1.1 建立SSH隧道（在本地终端运行）
```bash
ssh -f -N -L 5433:localhost:5432 root@111.231.19.162
```

#### 1.2 运行数据库迁移
```bash
export DATABASE_URL="postgresql://guasi:Scys-0418@localhost:5433/deepsea"
npx prisma migrate dev --name add_course_system
```

### 2. 准备课程数据

#### 2.1 查看模板文件
打开 `scripts/course-import-template.json`，这是课程结构模板。

#### 2.2 填写您的课程内容
按照以下格式填写：

```json
{
  "sections": [
    {
      "title": "前言",
      "slug": "preface",
      "courses": [
        {
          "title": "欢迎来到深海圈",
          "chapters": [
            {
              "title": "第1章：为什么创建深海圈",
              "lessons": [
                {
                  "title": "1.1 创始人的话",
                  "type": "VIDEO_TEXT",
                  "content": "这里填写Markdown格式的文稿",
                  "videoId": "这里填写腾讯云点播fileId",
                  "videoDuration": 360, // 视频时长（秒）
                  "isFree": true
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
```

### 3. 导入数据

在本地终端运行：
```bash
npm run import-courses
```

## 课程类型说明

- `VIDEO_TEXT`: 视频+图文混合
- `TEXT_ONLY`: 纯图文内容

## 会员等级说明

- `FREE`: 免费内容
- `ANNUAL`: 年度会员专享

## 注意事项

1. 视频需要先上传到腾讯云点播，获取fileId
2. 文稿内容支持Markdown格式
3. 确保SSH隧道连接正常
4. 导入前请备份数据库

## 常见问题

**Q: 导入失败提示数据库连接错误**
A: 请确保SSH隧道已建立，可以重新运行SSH命令

**Q: 如何获取腾讯云点播fileId**
A: 上传视频后，在腾讯云点播控制台的媒资管理中可以看到

**Q: 可以批量导入吗**
A: 可以，将所有课程数据填写在template.json中一次性导入